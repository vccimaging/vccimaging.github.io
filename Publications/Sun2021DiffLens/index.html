
<style type="text/css">
    body {
        font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif;
        font-weight:300;
        font-size:18px;
        margin-left: auto;
        margin-right: auto;
        width: 1100px;
    }

    h1 {
        font-weight:300;
        margin: 0.4em;
    }

    p {
        margin: 0.2em;
    }

    .disclaimerbox {
        background-color: #eee;
        border: 1px solid #eeeeee;
        border-radius: 10px ;
        -moz-border-radius: 10px ;
        -webkit-border-radius: 10px ;
        padding: 20px;
    }

    video.header-vid {
        height: 140px;
        border: 1px solid black;
        border-radius: 10px ;
        -moz-border-radius: 10px ;
        -webkit-border-radius: 10px ;
    }

    img.header-img {
        height: 140px;
        border: 1px solid black;
        border-radius: 10px ;
        -moz-border-radius: 10px ;
        -webkit-border-radius: 10px ;
    }

    img.rounded {
        border: 1px solid #eeeeee;
        border-radius: 10px ;
        -moz-border-radius: 10px ;
        -webkit-border-radius: 10px ;
    }

    a:link,a:visited
    {
        color: #1367a7;
        text-decoration: none;
    }
    a:hover {
        color: #208799;
    }

    td.dl-link {
        height: 160px;
        text-align: center;
        font-size: 22px;
    }

    .layered-paper-big { /* modified from: http://css-tricks.com/snippets/css/layered-paper/ */
        box-shadow:
                0px 0px 1px 1px rgba(0,0,0,0.35), /* The top layer shadow */
                5px 5px 0 0px #fff, /* The second layer */
                5px 5px 1px 1px rgba(0,0,0,0.35), /* The second layer shadow */
                10px 10px 0 0px #fff, /* The third layer */
                10px 10px 1px 1px rgba(0,0,0,0.35), /* The third layer shadow */
                15px 15px 0 0px #fff, /* The fourth layer */
                15px 15px 1px 1px rgba(0,0,0,0.35), /* The fourth layer shadow */
                20px 20px 0 0px #fff, /* The fifth layer */
                20px 20px 1px 1px rgba(0,0,0,0.35), /* The fifth layer shadow */
                25px 25px 0 0px #fff, /* The fifth layer */
                25px 25px 1px 1px rgba(0,0,0,0.35); /* The fifth layer shadow */
        margin-left: 10px;
        margin-right: 45px;
    }


    .layered-paper { /* modified from: http://css-tricks.com/snippets/css/layered-paper/ */
        box-shadow:
                0px 0px 1px 1px rgba(0,0,0,0.35), /* The top layer shadow */
                5px 5px 0 0px #fff, /* The second layer */
                5px 5px 1px 1px rgba(0,0,0,0.35), /* The second layer shadow */
                10px 10px 0 0px #fff, /* The third layer */
                10px 10px 1px 1px rgba(0,0,0,0.35); /* The third layer shadow */
        margin-top: 5px;
        margin-left: 10px;
        margin-right: 30px;
        margin-bottom: 5px;
    }

    .vert-cent {
        position: relative;
        top: 50%;
        transform: translateY(-50%);
    }

    hr
    {
        margin: 0;
        border: 0;
        height: 1.5px;
        background-image: linear-gradient(to right, rgba(0, 0, 0, 0), rgba(0, 0, 0, 0.75), rgba(0, 0, 0, 0));
    }

	.rotate {
		/* FF3.5+ */
		-moz-transform: rotate(-90.0deg);
		/* Opera 10.5 */
		-o-transform: rotate(-90.0deg);
		/* Saf3.1+, Chrome */
		-webkit-transform: rotate(-90.0deg);
		/* IE6,IE7 */
		filter: progid: DXImageTransform.Microsoft.BasicImage(rotation=0.083);
		/* IE8 */
		-ms-filter: "progid:DXImageTransform.Microsoft.BasicImage(rotation=0.083)";
		/* Standard */
		transform: rotate(-90.0deg);
	}

	c {
	   white-space: nowrap;
       writing-mode: tb-rl;
       transform: rotate(-180.0deg);
	}

</style>

<html>


  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
    <link rel="shortcut icon" href="/favicon.ico" type="image/vnd.microsoft.icon" id="favicon" />
    
    <!-- link to main stylesheet -->
    <link rel="stylesheet" type="text/css" href="/css/main.css">
  </head>
  
  <body>
    
    <img align=right src="./imgs/kaust.png" width=150 height=150>
    
    
    <nav>
      <ul>
        <li><a href="/">Home</a></li>
	<li><a href="/people.html">People</a></li>
	<li><a href="/publications.html">Publications</a></li>
        <li><a href="/joinus.html">Join Us</a></li>
	<li style="float:right"><a href=https://www.kaust.edu.sa/en>KAUST</a></li>
	<li style="float:right"><a href=https://cemse.kaust.edu.sa/vcc>VCC</a></li>
      </ul>
    </nav>
    
    <content>
      <div class="projectPage">
    
<script>
 (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
 (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
 m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
 })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

 ga('create', 'UA-98293807-1', 'auto');
 ga('send', 'pageview');

</script>





  <head>
        <title>End-to-End Complex Lens Design with Differentiable Ray Tracing
		</title>
        <meta property="og:title" content="hdr" />
  </head>

  <body>
    <br>
    <center>
      <span style="font-size:36px">End-to-End Complex Lens Design with Differentiable Ray Tracing</span>
    </center>

    <br>
    <table align=center width=1098px>
      <tr>
        <td align=center width=90px>
        <center>
          <span style="font-size:20px"><a href="https://vccimaging.org/People/sunq/">Qilin Sun</a></span>
        </center>
        </td>

        <td align=center width=90px>
        <center>
          <span style="font-size:20px"><a href="https://vccimaging.org/People/wangc/">Congli Wang</a></span>
        </center>
        </td>

        <td align=center width=90px>
        <center>
          <span style="font-size:20px"><a href="https://vccimaging.org/People/fuq/">Qiang Fu</a></span>
        </center>
        </td>

        <td align=center width=90px>
        <center>
          <span style="font-size:20px"><a href="https://vccimaging.org/People/dunx/">Xiong Dun</a></span>
        </center>
        </td>
		
        <td align=center width=90px>
        <center>
          <span style="font-size:20px"><a href="https://vccimaging.org/People/heidriw/">Wolfgang Heidrich</a></span>
        </center>
        </td>

      </tr>
    </table>

	  <br>
    <table align=center width=700px>
      <tr>
        <td align=center width=100px>
        <center>
        <span style="font-size:20px">Siggraph 2021</span>
        </center>
        </td>
      </tr>
    </table>

    <br>
    <br>
    <table align=center width=1098px>
      <tr>
        <td width=1098px>
          <center>
          <a href="./imgs/teaser.png"><img src = "./imgs/teaser.png" width="1098px"></img></a><br>
          </center>
        </td>
      </tr>
      </table>
      <table align=center width=900px></table>
        <tr>
          <td width=600px>
          <center>
            <span style="font-size:14px"><hr style="height:6pt; visibility:hidden;" /><i>An exemplary triplet design for extended depth-of-field imaging optimized by our end-to-end differentiable complex lens design framework. Top left: 3D model of the optimized triplet lens design (50mm/F4). Bottom left: prototype fabricated by single-point diamond turning. Middle: final image that is captured by our end-to-end designed lenses and processed by our algorithm. Right: the same scene captured by a Sony 28-70mm zoom lens at 50mm/F4.5. The objects are placed in the range from around 0.8m to 1.8m from the lenses. Our prototype succeeds in obtaining the all-in-focus image, while the conventional lens shows a narrow depth of field. </i>
          </center>
          </td>
        </tr>
        <tr>
          <td width=600px>
            <br>
            <p align="justify" style="font-size: 16px; line-height: 20px;">
			Imaging systems have long been designed in separated steps:
			experience-driven optical design followed by sophisticated image
			processing. Although recent advances in computational imaging aim to
			bridge the gap in an end-to-end fashion, the image formation models
			used in these approaches have been quite simplistic, built either on
			simple wave optics models such as Fourier transform, or on similar
			paraxial models. Such models only support the optimization of
			a single lens surface, which limits the achievable image quality.

			To overcome these challenges, we propose a general end-to-end complex
			lens design framework enabled by a differentiable ray tracing image
			formation model. Specifically, our model relies on the differentiable
			ray tracing rendering engine to render optical images in the full
			field by taking into account all on/off-axis aberrations governed by
			the theory of geometric optics. Our design pipeline can jointly
			optimize the lens module and the image reconstruction network for a
			specific imaging task.  We demonstrate the effectiveness of the
			proposed method on two typical applications, including large
			field-of-view imaging and extended depth-of-field imaging. Both
			simulation and experimental results show superior image quality
			compared with conventional lens designs. Our framework offers a
			competitive alternative for the design of modern imaging systems.
						</p>
          </td>
        </tr>
      </table>

      <br>
      <hr>
      <!-- <table align=center width=550px> -->
      <table align=center width=720>
        <center><h1 style="margin-bottom:-5">Paper</h1></center>
        <tr>
          <td style="padding-left:0px;padding-right:20px;padding-top:0px;"><a href="./Sun2020LearningRank1HDR.pdf"><img style="height:180px; border: solid; border-radius:30px;" src="./Sun2021DiffLens_Thumbnail.png"/></a></td>
          <td><span style="font-size:16px">Qilin Sun, Congli Wang, Qiang Fu, Xiong Dun, Wolfgang Heidrich
          <br>
          <br>
          End-to-End Complex Lens Design with Differentiable Ray-tracing
          <br>
          <br>
          Siggraph 2021</span>
          <br>
          </td>
        </tr>
      </table>
      <!--  <br> -->

      <table align=center width=720px style="padding-top: 14px;">
      <tr>
			<td align=center width=90px>
      <span style="font-size:18px"><center>
        <a href="./Sun2021DiffLens.pdf">[Paper]</a>
      </center></td>
	  
	  			<td align=center width=90px>
      <span style="font-size:18px"><center>
        <a href="./Sun2021DiffLens_small.pdf">[Paper Small]</a>
      </center></td>

			<td align=center width=90px>
      <span style="font-size:18px"><center>
        <a href="./Sun2021DiffLens_supp.pdf">[Supplement]</a>
      </center></td>

			<td align=center width=90px>
      <span style="font-size:18px"><center>
        <a href="./Sun2021DiffLens_supp_small.pdf">[Supplement Small]</a>
      </center></td>
	  
      <td align=center width=90px>
      <span style="font-size:18px"><center>
        <a href="./imgs/bib.txt">[Bibtex]</a>
      </center></td>

      <!--<td align=center width=90px>
      <span style="font-size:18px"><center>
          <a href="https://youtube.com">[Video]</a> 
      </center></td> -->

      </tr>
			</table>

			<!-- <table align=center width=700px style="padding-top: 5px;">
			<tr>
      <td colspan="5" style="font-size: 14px">
      <center>
        <i> Please address correspondence to <a href="mailto:qilin.sun@kaust.edu.sa">Qilin Sun</a>, <a href="mailto:eftseng@cs.princeton.edu">Ethan Tseng</a>, and <a href="mailto:fheide@cs.princeton.edu">Felix Heide</a>.</i>
      </center>
      </td>
      </tr>
      </table> --!>


		<br>
    <hr>
    <center><h1>Video Summary</h1></center>
    <br>
      <table align=center width=1098px>
        <tr>
            <td width=220px>
              <center>
                  <a href="./imgs/camera_prototype_high_res.png"><img src = "./imgs/camera_prototype.png" width="280px"></img></href></a><br>
                  <br>
            </center>
            </td>
            <td width=750px>
                <center>
                <video width="750" controls autoplay loop muted><source src="./imgs/paper118_final_video.mp4#t=0" type="video/mp4"></video>
                </center>
            </td>
        </tr>
      </table>

      <table align=center width=900px></table>
        <tr>
          <td width=600px>
          <center>
            <span style="font-size:14px"><hr style="height:12pt; visibility:hidden;" /><i>Our camera prototype (top left) fabricated by single point dimond turing along with video summary (right).</i>
            <br>
          </center>
          </td>
        </tr>
      </table>



		<br>
    <hr>
    <center><h1>End-to-end Designing Framework</h1></center>

  <!-- Real world captures -->
    <!-- Figures -->
		<table align=center width=900px>
		<tr>
			<td>
        <center>
          <a href="./mainfigure.png"><img src = "./mainfigure.png" width=1098px"></img></a><br>
        </center>
      </td>

    <!-- Caption -->
	  <table align=center width=900px>
	  <tr>
    <td>
		  <span style="font-size:18px"><hr style="height:2pt; visibility:hidden;" /><b>Framework for end-to-end designing of differentiable complex lens model and reconstruction.</b></span>
		  <p  align="justify" ><span style="font-size:18px">
         In each forward pass, we set up one scene from a certain point-of-view and render the image through the differentiable complex lens model.  Then, the  simulated images are sent to the image reconstruction network and we train the whole framework simultaneously. For the experimental stage, we directly send the preprocessed real-captures to the pre-trained network. Notice that the scene setup, initial lens design and image recovery network can be tailored to specific applications.
      </span></p>
	  </td>
	  </tr>
	  </table>
		<br>
		<br>
    <center><h1>Application: Large Field-of-view Imaging</h1></center>

  <!-- Real world captures -->
    <!-- Figures -->
		<table align=center width=900px>
		<tr>
			<td>
        <center>
          <a href="./imgs/LFOV/Simulated_LFOV.png">
		  <img src = "./imgs/LFOV/Simulated_LFOV.png" width=1098px"></img></a><br>
        </center>
      </td>

    <!-- Caption -->
	  <table align=center width=900px>
	  <tr>
    <td>
		  <span style="font-size:18px"><hr style="height:2pt; visibility:hidden;" /><b>Evaluation of LFOV imaging in simulation.</b></span>
		  <p  align="justify" ><span style="font-size:18px">
         We compare the performance of the state-of-the-art commercially available
 aspherical lens Thorlabs AL2550-A, lens pairs ACA254-050-A, jointly 
 designed optics without modulation to flat lens LFOV19, Cooke triplet and
 our end-to-end designed camera.
 All the texture planes are located at 1m away from the camera, and the simulations are based on ray optics without considering diffraction. The first column shows the section view of each lens, and the second column shows the corresponding PSFs at different angles up to  30 degree. The third column shows the simulated 
 sensor image (top) and recovered image (bottom).  
The fourth column shows the MTFs of each lens at different angles.
 The PSFs and rendered simulation of AL2550-A and ACA254-050-A lenses show a strong blurring at large angles.  
 LFOV19 lens performs better in balancing PSF but left significant artifacts
in both measurements and reconstructions. Cooke triplet performs better than AL2550-A and ACA254-050-A but still fails at a large FOV.
 Instead, our design shows a better PSF distribution, and the results have fewer artifacts. Notice that all lenses are adjusted to F4.
      </span></p>
	  </td>
	  </tr>
	  </table>
		<br>
		<br>


  <!-- Motion capture -->
    <!-- Figures -->
    <table align=center width=900px>
    <tr>
      <center>
        <a href="./imgs/LFOV/Result_LFOV.png"><img src = "./imgs/LFOV/Result_LFOV.png" width="1098px"></img></a><br>
      </center>
    </tr>
    </table>

    <!-- Caption -->
		<table align=center width=900px>
		<tr>
		<td>
      <span style="font-size:18px">
		  <hr style="height:2pt; visibility:hidden;"/><b>Experimental results of large field of view imaging </b>
      </span>
	    <p  align="justify" ><span style="font-size:18px">
		Experimental results of large field of view imaging with two elements
		and four surfaces design. For each pair, we give the sensor measurement by 
		our prototype camera and the reconstructed results. Please zoom in to see
		more details.
      </span></p>
    </td>
    </tr>
    </table>
		<br>
		<br>

   <center><h1>Application: Extended Depth of Field</h1></center>

  <!-- Real world captures -->
    <!-- Figures -->
		<table align=center width=900px>
		<tr>
			<td>
        <center>
          <a href="./imgs/EDOF/Simulated_EDOF_01.png">
		  <img src = "./imgs/EDOF/Simulated_EDOF_01.png" width=1098px"></img></a><br>
        </center>
      </td>

    <!-- Caption -->
	  <table align=center width=900px>
	  <tr>
    <td>
		  <span style="font-size:18px"><hr style="height:2pt; visibility:hidden;" /><b>Evaluation of extended depth of field imaging in simulation.</b></span>
		  <p  align="justify" ><span style="font-size:18px">
 We compare the performance of the state-of-the-art commercially available aspherical lenses, including Thorlabs AL2550-A and ACA254-050-A. 
The first row shows the MTFs of each lens before and after post-processing at different depths.
 All the texture planes are placed 1m away from the camera, and the simulation is based on ray optics without considering diffraction. The second row shows the corresponding PSFs at the selected depth. The third column shows the simulated sensor image. Obviously, the PSFs of rendered simulation of AL2550-A and ACA254-050-A lenses exhibit a strong blur when out of focus. 
 Instead, our design shows an almost depth invariant PSF 
 and results with fewer artifacts. Additional results are available in the supplementary material.  Notice that all lenses are adjusted to F4.
      </span></p>
	  </td>
	  </tr>
	  </table>
		<br>
		<br>


  <!-- Motion capture -->
    <!-- Figures -->
    <table align=center width=900px>
    <tr>
      <center>
        <a href="./imgs/EDOF/Result_EDOF_01.png"><img src = "./imgs/EDOF/Result_EDOF_01.png" width="1098px"></img></a><br>
      </center>
    </tr>
    </table>

    <!-- Caption -->
		<table align=center width=900px>
		<tr>
		<td>
      <span style="font-size:18px">
		  <hr style="height:2pt; visibility:hidden;"/><b>Experimental results of extended depth of field.</b>
      </span>
	    <p  align="justify" ><span style="font-size:18px">
	Experimental results of extended depth of field with three elements and six surfaces design. The left column shows the raw
  sensor data from our design, the center column shows our
  reconstruction result and the right column shows images captured by
  a commercial Sony 28-70mm zoom lens adjusted to 50mm/F4.5.  The
  objects shown in these two figures are placed from around 0.8m to
  1.8m, and we succeed in obtaining the all-in-focus image.  Please zoom in to see more details.
      </span></p>
    </td>
    </tr>
    </table>
		<br>
		<br>

<!--		  <table align=center width=900px>
			  <tr>
          <td colspan="5" style="font-size: 14px">
          <center>
              We thank <a href="https://richzhang.github.io/colorization/">Richard Zhang</a> for his website template.
          </center>
          </td>
        </tr>
			</table>
-->

</body>
</html>

